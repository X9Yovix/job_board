{% extends 'base.html.twig' %}

{% block title %}Sign Up
{% endblock %}

{% block body %}

<!-- Page Title Start -->
<section class="page-title title-bg13">
	<div class="d-table">
		<div class="d-table-cell">
			<ul>
				<li>
					<h2>Sign Up</h2>
				</li>
			</ul>
		</div>
	</div>
	<div class="lines">
		<div class="line"></div>
		<div class="line"></div>
		<div class="line"></div>
	</div>
</section>
<!-- Page Title End -->

<!-- Sign up Section Start -->
<div class="job-post ptb-100">
	<div class="container">
		<form class="job-post-from signup-form" name="registration_form" method="post">
			<h2>Fill up information to Sign Up</h2>
			<div class="create-btn text-center mb-5">
				<p>
					Have an Account?
					<a href="{{path('app_login')}}">
						Sign In
						<i class='bx bx-chevrons-right bx-fade-right'></i>
					</a>
				</p>
			</div>
			{% if errors %}
			<h3>You must fix the following errors to sign up</h3>
			<ul>
				{% for error in errors %}
				<li>{{ error.message }}</li>
				{% endfor %}
			</ul>
			{% endif %}
			<div class="row">
				<div class="col-md-6">
					<div class="form-group">
						<label>First Name</label>
						<input type="text" class="form-control" id="firstName" name="firstName">

					</div>
				</div>

				<div class="col-md-6">
					<div class="form-group">
						<label>Last Name</label>
						<input type="text" class="form-control" id="lastName" name="lastName">
					</div>
				</div>

				<div class="col-md-6">
					<div class="form-group">
						<label>Email</label>
						<input type="email" class="form-control" id="email" name="email">
					</div>
				</div>

				<div class="col-md-6">
					<div class="form-group">
						<label>Password</label>
						<input type="password" class="form-control" id="plainPassword" name="plainPassword"
							autocomplete="new-password">
					</div>
				</div>

				<div class="col-md-6">
					<div class="form-group">
						<label>Birthday</label>
						<input type="date" class="form-control" id="birthday" name="birthday">
					</div>
				</div>

				<div class="col-md-6">
					<div class="form-group">
						<label>Country</label>
						<select name="country" class="category nice-select form-control" id="countrySelect">
							<option selected></option>
							{% for country in countries %}
							<option value="{{ country.id }}">{{ country.name }}</option>
							{% endfor %}
						</select>
					</div>
				</div>

				<div class="col-md-6" id="stateContainer">
					<div class="form-group">
						<label>State</label>
						<select class="category nice-select form-control" name="state" id="stateSelect">
							<option data-display=" "></option>
						</select>
					</div>
				</div>

				<div class="col-md-6" id="cityContainer">
					<div class="form-group">
						<label>City</label>
						<select class="category nice-select form-control" name="city" id="citySelect">
							<option data-display=" "></option>
						</select>
					</div>
				</div>

				<div class="col-md-6">
					<div class="form-group">
						<label>Role</label>
						<select name="role" class="category nice-select form-control" id="roleSelect">
							<option selected></option>
							{% for role in roles %}
							<option value="{{ role }}">{{ role }}</option>
							{% endfor %}
						</select>
					</div>
				</div>

				<div class="col-md-6">
					<div class="form-group">
						<label>Phone Number</label>
						<div class="input-group">
							<div class="input-group-prepend">
								<span class="input-group-text" id="countryEmoji" style="height: 50px;">ðŸ›¸</span>
							</div>
							<input type="text" class="form-control" id="phoneNumber" name="phoneNumber">
							<input type="hidden" id="phoneCodeInput" name="phoneCode">
						</div>
					</div>
				</div>

				<div class="col-md-12">
					<div class="form-group d-flex align-items-center justify-content-center">
						<label class="mr-3">Gender</label>
						<div class="form-check form-check-inline">
							<input class="form-check-input mx-2" type="radio" name="gender" id="gender_male"
								value="male" checked>
							<label class="form-check-label" for="gender_male" checked>Male</label>
						</div>
						<div class="form-check form-check-inline">
							<input class="form-check-input" type="radio" name="gender" id="gender_female"
								value="female">
							<label class="form-check-label" for="gender_female">Female</label>
						</div>
					</div>
				</div>

				<div class="col-md-12 text-center">
					<button type="submit" class="post-btn">
						Sign Up
					</button>
				</div>
			</div>


		</form>
	</div>
</div>
<!-- Sign up Section End -->

{% endblock %}

{% block javascripts %}
<script>

	$(document).ready(function () {
		$('#countrySelect').change(function () {
			var country = $(this).val();
			updatePhoneInfo(country);

			if (country) {
				$.ajax({
					url: '/states/' + country,
					type: 'GET',
					success: function (data) {
						$('#stateSelect').empty();
						$('#stateSelect').append('<option data-display=" "></option>');
						$.each(data, function (index, state) {
							$('#stateSelect').append('<option value="' + state.id + '">' + state.name + '</option>');
						});
					}
				});
			}
		});

		$('#stateSelect').change(function () {
			var state = $(this).val();
			if (state) {
				$.ajax({

					url: '/cities/' + state,
					type: 'GET',
					success: function (data) {
						$('#citySelect').empty();
						$('#citySelect').append('<option data-display=" "></option>');
						$.each(data, function (index, city) {
							$('#citySelect').append('<option value="' + city.id + '">' + city.name + '</option>');
						});
					}
				});
			}
		});

		function updatePhoneInfo(selectedCountryId) {
			$.ajax({
				url: '/country/flag/' + selectedCountryId,
				type: 'GET',
				data: { countryId: selectedCountryId },
				success: function (response) {
					var phoneCode = response.phoneCode;
					var emoji = response.emoji;
					$('#countryEmoji').text(emoji);
					$('#phoneCodeInput').val(phoneCode);

				},
				error: function (error) {
					$('#phoneCodeInput').val("");
					$('#countryEmoji').text("ðŸ›¸");
					$('#phoneNumber').val('');
				}
			});
		}
	});
</script>
{% endblock %}